(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[436],{60091:function(e,r,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/manage/movie/edit/[id]",function(){return n(42445)}])},42445:function(e,r,n){"use strict";n.r(r),n.d(r,{default:function(){return L}});var t=n(85893),o=n(5152),i=n(87536),u=n(1478),a=n(75952),s=n(44520),l=n(33144),d=n(96765),c=n(66665),f=n(65830),v=n.n(f),m=n(13505),p=n(44087),g=n(43829),h=n(88767),j=n(258),y=n(82623),x=n(66948),b=n(34051),w=n.n(b),_=n(11163),q=n(16938),S=n(74891),P=n(51981),E=n(60961);function Z(e,r,n,t,o,i,u){try{var a=e[i](u),s=a.value}catch(l){return void n(l)}a.done?r(s):Promise.resolve(s).then(t,o)}var C=function(e){var r=(0,_.useRouter)(),n=r.query,t=r.push,o=String(n.id),i=(0,h.useQuery)(["movie",o],(function(){return S.u.getById(o)}),{onSuccess:function(r){var n=r.data;(0,P.R)(n).forEach((function(r){return e(r,n[r])}))},onError:function(e){(0,y._)(e,"Get movie")},enabled:!!n.id}).isLoading,u=(0,h.useMutation)("update movie",(function(e){return S.u.update(o,e)}),{onError:function(e){(0,y._)(e,"Update movie")},onSuccess:function(){q.Rt.success("Update movie","update was successful"),t((0,E.A7)("movies"))}}).mutateAsync,a=function(){var e,r=(e=w().mark((function e(r){return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u(r);case 2:case"end":return e.stop()}}),e)})),function(){var r=this,n=arguments;return new Promise((function(t,o){var i=e.apply(r,n);function u(e){Z(i,t,o,u,a,"next",e)}function a(e){Z(i,t,o,u,a,"throw",e)}u(void 0)}))});return function(e){return r.apply(this,arguments)}}();return{onSubmit:a,isLoading:i}};function O(e,r,n){return r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function N(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{},t=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),t.forEach((function(r){O(e,r,n[r])}))}return e}var Q=(0,o.default)((function(){return Promise.all([n.e(926),n.e(978)]).then(n.bind(n,85978))}),{loadableGenerated:{webpack:function(){return[85978]}},ssr:!1}),V=function(){var e,r,n,o=(0,i.cI)({mode:"onChange"}),f=o.handleSubmit,b=o.register,w=o.formState.errors,_=o.control,q=o.setValue,S=o.getValues,P=C(q),E=P.isLoading,Z=P.onSubmit,O=(0,h.useQuery)("list of genre",(function(){return x.c.getAll()}),{select:function(e){return e.data.map((function(e){return{label:e.name,value:e._id}}))},onError:function(e){(0,y._)(e,"genre list")}}),V=O.data,k=O.isLoading,L=(0,h.useQuery)("list of actor",(function(){return j.V.getAll()}),{select:function(e){return e.data.map((function(e){return{label:e.name,value:e._id}}))},onError:function(e){(0,y._)(e,"actor list")}}),A=L.data,T=L.isLoading;return(0,t.jsxs)(p.Z,{title:"Edit movie",children:[(0,t.jsx)(a.Z,{}),(0,t.jsx)(m.Z,{title:"Edit movie"}),(0,t.jsx)("form",{onSubmit:f(Z),className:v().form,children:E?(0,t.jsx)(u.Z,{count:3}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:v().fields,children:[(0,t.jsx)(l.Z,N({},b("title",{required:"Title is required!"}),{placeholder:"Title",error:w.title})),(0,t.jsx)(d.Z,{register:b,error:w.slug,generate:function(){q("slug",(0,g.G)(S("title")))}}),(0,t.jsx)(l.Z,N({},b("parameters.country",{required:"Country is required!"}),{placeholder:"Country",error:null===(e=w.parameters)||void 0===e?void 0:e.country,style:{width:"31%"}})),(0,t.jsx)(l.Z,N({},b("parameters.duration",{required:"Duration is required!"}),{placeholder:"Duration (min.)",error:null===(r=w.parameters)||void 0===r?void 0:r.duration,style:{width:"31%"}})),(0,t.jsx)(l.Z,N({},b("parameters.year",{required:"Year is required!"}),{placeholder:"Year",error:null===(n=w.parameters)||void 0===n?void 0:n.year,style:{width:"31%"}})),(0,t.jsx)(i.Qr,{name:"genres",control:_,rules:{required:"Please select at least one genre!"},render:function(e){var r=e.field,n=e.fieldState.error;return(0,t.jsx)(Q,{error:n,field:r,placeholder:"Genres",options:V||[],isLoading:k,isMulti:!0})}}),(0,t.jsx)(i.Qr,{name:"actors",control:_,rules:{required:"Please select at least one actor!"},render:function(e){var r=e.field,n=e.fieldState.error;return(0,t.jsx)(Q,{error:n,field:r,placeholder:"Actors",options:A||[],isLoading:T,isMulti:!0})}}),(0,t.jsx)(i.Qr,{name:"poster",control:_,defaultValue:"",render:function(e){var r=e.field,n=r.value,o=r.onChange,i=e.fieldState.error;return(0,t.jsx)(c.Z,{onChange:o,value:n,error:i,folder:"movies",placeholder:"Poster"})},rules:{required:"Poster is required"}}),(0,t.jsx)(i.Qr,{name:"bigPoster",control:_,defaultValue:"",render:function(e){var r=e.field,n=r.value,o=r.onChange,i=e.fieldState.error;return(0,t.jsx)(c.Z,{onChange:o,value:n,error:i,folder:"movies",placeholder:"Big poster"})},rules:{required:"Big poster is required"}}),(0,t.jsx)(i.Qr,{name:"videoUrl",control:_,defaultValue:"",render:function(e){var r=e.field,n=r.value,o=r.onChange,i=e.fieldState.error;return(0,t.jsx)(c.Z,{onChange:o,value:n,error:i,folder:"movies",placeholder:"Video",style:{marginTop:-25},isNoImage:!0})},rules:{required:"Video is required"}})]}),(0,t.jsx)(s.Z,{children:"Update"})]})})]})},k=function(){return(0,t.jsx)(V,{})};k.isOnlyAdmin=!0;var L=k}},function(e){e.O(0,[536,111,774,888,179],(function(){return r=60091,e(e.s=r);var r}));var r=e.O();_N_E=r}]);